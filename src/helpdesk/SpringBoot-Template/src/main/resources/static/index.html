<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <link rel="stylesheet" href="./../assets/css/index.css">
    <title>Login</title>
</head>
<body>
    
    <div class="wrapper">
        <div class="login_container">
            <div class="login_box">
                <form id="login-form" class="login-form">
                    <div class="login-header">
                        <span>Login</span>
                    </div>
                    <div class="input_box">
                        <input type="text" id="user" class="input-field" required>
                        <label for="user" class="label">Username</label>
                        <i class="bx bx-user"></i>
                    </div>
                    <div class="input_box">
                        <input type="password" id="pass" class="input-field" required>
                        <label for="user" class="label">Password</label>
                        <i class="bx bx-lock-alt"></i>
                    </div>
                    <div class="remember-forgot">
                        <div class="remember-me">
                            <input type="checkbox" id="remember">
                            <label for="remember">Remember me</label>
                        </div>
                        <div class="forgot">
                            <a href="#">Forgot password?</a>
                        </div>
                    </div>
                    <div class="input_box">
                        <input type="submit" class="input-submit" value="Login">
                    </div>

                    <div class="register">
                        <span>Don't have an accout?
                            <a href="#">Register</a>
                        </span>
                    </div>
                </div>
            </div>
        </form>
    </div>

</body>
<script>
    document.getElementById("login-form").addEventListener("submit", function(event) {
        event.preventDefault();

        var username = document.getElementById("user").value;
        var password = document.getElementById("pass").value;


        // Crearea obiectului de cerere pentru autentificare
        var data = {
            email: username,
            password: password
        };

        var target = 'http://' + location.host + '/api/v1/auth/authenticate'

        fetch(target, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            localStorage.setItem('token', data.token);
            localStorage.setItem('refreshToken', data.refreshToken);

            window.location.href = 'homepage.html';
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Wrong password: ' + password, error)
        });
    });
</script>


</html>